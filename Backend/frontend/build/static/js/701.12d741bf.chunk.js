/*! For license information please see 701.12d741bf.chunk.js.LICENSE.txt */
(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[701],{3701:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var s=n(5043),i=n(3003),r=n(6213),o=n(1036),a=n(7029),l=n.n(a),d=n(4783),c=n(407),h=n(7762),m=n(3141),u=n(579);const p=()=>{var e,t,n,o,a,l,d,p,v,x,j,g,f,N,b,_,y,C,S,P,w,D,I;const[k,F]=(0,s.useState)(null),A=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.UserData})),[R,T]=(0,s.useState)(null),M=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.workbenchformData})),U=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.UrlLink})),[O,E]=(0,s.useState)(null),[H,B]=(0,s.useState)(!0),[G,K]=(0,s.useState)({}),[V,W]=(0,s.useState)({}),[L,q]=(0,s.useState)(""),[Y,z]=(0,s.useState)([]),[Q,J]=(0,s.useState)([]),[X,Z]=(0,s.useState)(null);(0,s.useEffect)((()=>{r.A.get("".concat(U,"usercontrol/getClinic?location=").concat(null===A||void 0===A?void 0:A.location)).then((e=>{const t=e.data[0];t?W(t):console.error("No clinic details found")})).catch((e=>{console.error("Error:",e)})),r.A.get("".concat(U,"usercontrol/getAccountsetting")).then((e=>{if(e.data){const t=e.data;Z("data:image/png;base64,".concat(t.clinicLogo))}else console.error("No record found")})).catch((e=>console.error("Error fetching data")))}),[]),(0,s.useEffect)((()=>{const e=(new Date).toISOString().split("T")[0];q(e),E(new Date,"Asia/Kolkata")}),[]);const $=O&&(0,c.GP)(O," dd / MM / yy");(0,s.useEffect)((()=>{M&&K(M)}),[]),(0,s.useEffect)((()=>{M&&M.PatientID&&M.SerialNo&&M.visitNo&&(r.A.get("".concat(U,"doctorsworkbench/get_for_preview?PatientID=").concat(null===M||void 0===M?void 0:M.PatientID)).then((e=>{if(e.data&&e.data.length>0){const t=e.data;console.log(t),z(t)}})).catch((e=>{console.error("Error fetching data:",e)})),r.A.get("".concat(U,"doctorsworkbench/prescription_forpreview?PatientID=").concat(M.PatientID,"&visitID=").concat(M.visitNo)).then((e=>{e.data&&e.data.length>0&&J(e.data)})).catch((e=>{console.error("Error fetching prescription data:",e)})))}),[M.PatientID,M,L,M.visitNo]),(0,s.useEffect)((()=>{const e=null===M||void 0===M?void 0:M.DoctorName;e&&r.A.get("".concat(U,"usercontrol/get_doctor_sign?doctorname=").concat(e)).then((e=>{const t=e.data;T(t.doctor_sign)})).catch((e=>{console.error("Error fetching data:",e)}))}),[M]);const ee=(0,m.useReactToPrint)({content:()=>document.getElementById("reactprintcontent"),onBeforePrint:()=>{},onAfterPrint:async()=>{F(null)},onAfterPrint:async()=>{F(null);const e=document.getElementById("reactprintcontent");try{if(!e)throw new Error("Unable to get the target element");{const t=e.offsetWidth,n=20,s=t+2*n,i=1.5*t,r=new h.default({unit:"px",format:[s,i]});r.html(e,{x:n,y:n,callback:()=>{const e=r.output("blob");F(e)}})}}catch(t){console.error("Error generating PDF:",t)}}});return(0,u.jsxs)("div",{className:"billing-invoice",id:"reactprintcontent",children:[(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"New_billlling_invoice_head",children:[(0,u.jsx)("div",{className:"new_billing_logo_con",children:(0,u.jsx)("img",{src:X,alt:"Medical logo"})}),(0,u.jsxs)("div",{className:"new_billing_address_1 ",children:[(0,u.jsx)("span",{className:"dkjfiuw6",children:V.concern_name}),(0,u.jsx)("div",{children:(0,u.jsx)("span",{className:"dkjfiuw6",children:V.door_no+","+V.street+V.area+","+V.city+","+V.state+"-"+V.pincode})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"dkjfiuw6",children:V.phone_no+" , "}),(0,u.jsx)("span",{className:"dkjfiuw6",children:V.email})]})]})]}),(0,u.jsx)("div",{className:"Register_btn_con",style:{color:"var(--labelcolor)",fontWeight:600},children:"Patient Preview"}),(0,u.jsxs)("div",{className:"new_billing_address",children:[(0,u.jsxs)("div",{className:"new_billing_address_2",children:[(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Patient Name ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsxs)("span",{className:"dkjfiuw6",children:[null===(e=Y[0])||void 0===e?void 0:e.Title," ",null===(t=Y[0])||void 0===t?void 0:t.FirstName," ",null===(n=Y[0])||void 0===n?void 0:n.LastName]})]}),(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Patient ID ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===(o=Y[0])||void 0===o?void 0:o.PatientID})]}),(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Age ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===(a=Y[0])||void 0===a?void 0:a.Age})]}),(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Gender ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===(l=Y[0])||void 0===l?void 0:l.Gender})]})]}),(0,u.jsxs)("div",{className:"new_billing_address_2",children:[(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Date ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:$})]}),(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:["Address ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:(null===(d=Y[0])||void 0===d?void 0:d.City)+","+(null===(p=Y[0])||void 0===p?void 0:p.State)+"-"+(null===(v=Y[0])||void 0===v?void 0:v.Pincode)})]}),(0,u.jsxs)("div",{className:"new_preview_div",children:[(0,u.jsxs)("label",{children:[" ","Patient Mobile No ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===(x=Y[0])||void 0===x?void 0:x.PhoneNumber})]}),Y.map(((e,t)=>(0,u.jsx)("div",{className:"new_preview_div",children:e.Next_Appointment&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("label",{children:["Next Appointment ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===e||void 0===e?void 0:e.Next_Appointment})]})},t)))]})]}),(0,u.jsx)("div",{className:"Register_btn_con",style:{color:"var(--labelcolor)",fontWeight:600},children:"Vital List"}),(0,u.jsx)("div",{className:"new_billing_invoice_detials",children:(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Pulse"}),(0,u.jsx)("th",{children:"SPO2"}),(0,u.jsx)("th",{children:"Heart Rate"}),(0,u.jsx)("th",{children:"RR"}),(0,u.jsx)("th",{children:"SBP"}),(0,u.jsx)("th",{children:"DBP"}),(0,u.jsx)("th",{children:"Position"}),(0,u.jsx)("th",{children:"Part"}),(0,u.jsx)("th",{children:"Method"}),(0,u.jsx)("th",{children:"Weight(kg)"}),(0,u.jsx)("th",{children:"Height(cm)"}),(0,u.jsx)("th",{children:"HC (cm)"}),(0,u.jsx)("th",{children:"WC (cm)"})]})}),(0,u.jsx)("tbody",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:null===(j=Y[1])||void 0===j?void 0:j.Pulse}),(0,u.jsx)("td",{children:null===(g=Y[1])||void 0===g?void 0:g.SPO2}),(0,u.jsx)("td",{children:null===(f=Y[1])||void 0===f?void 0:f.Heart_Rate}),(0,u.jsx)("td",{children:null===(N=Y[1])||void 0===N?void 0:N.RR}),(0,u.jsx)("td",{children:null===(b=Y[1])||void 0===b?void 0:b.SBP}),(0,u.jsx)("td",{children:null===(_=Y[1])||void 0===_?void 0:_.DBP}),(0,u.jsx)("td",{children:null===(y=Y[1])||void 0===y?void 0:y.Position}),(0,u.jsx)("td",{children:null===(C=Y[1])||void 0===C?void 0:C.Part}),(0,u.jsx)("td",{children:null===(S=Y[1])||void 0===S?void 0:S.Method}),(0,u.jsx)("td",{children:null===(P=Y[1])||void 0===P?void 0:P.WeightKg}),(0,u.jsx)("td",{children:null===(w=Y[1])||void 0===w?void 0:w.HeightCm}),(0,u.jsx)("td",{children:null===(D=Y[1])||void 0===D?void 0:D.HCCm}),(0,u.jsx)("td",{children:null===(I=Y[1])||void 0===I?void 0:I.WCCm})]})})]})}),(0,u.jsx)("div",{className:"new_billing_invoice_detials ",style:{paddingBottom:"10px"}}),(0,u.jsx)("div",{className:"Register_btn_con",style:{color:"var(--labelcolor)",fontWeight:600},children:"Prescription"}),(0,u.jsx)("div",{className:"new_billing_invoice_detials",children:(0,u.jsxs)("table",{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Generic Name"}),(0,u.jsx)("th",{children:"Item Name"}),(0,u.jsx)("th",{children:"Dose"}),(0,u.jsx)("th",{children:"Route"}),(0,u.jsx)("th",{children:"Frequency"}),(0,u.jsx)("th",{children:"Duration"}),(0,u.jsx)("th",{children:"Qty"}),(0,u.jsx)("th",{children:"Instruction"})]})}),(0,u.jsx)("tbody",{children:Q.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.GenericName}),(0,u.jsx)("td",{children:e.ItemName}),(0,u.jsx)("td",{children:e.Dose}),(0,u.jsx)("td",{children:e.Route}),(0,u.jsx)("td",{children:e.Frequency}),(0,u.jsx)("td",{children:e.Duration}),(0,u.jsx)("td",{children:e.Qty}),(0,u.jsx)("td",{children:e.Instruction})]},t)))})]})}),(0,u.jsxs)("div",{className:"new_billing_invoice_detials ",style:{paddingBottom:"10px"},children:[(0,u.jsx)("br",{}),(0,u.jsx)("div",{className:"invoice_detials_total_1 neww_invoicedetials",children:(0,u.jsxs)("div",{className:"total_con_bill",children:[Y.map(((e,t)=>(0,u.jsx)("div",{className:"bill_body bill_body32",children:e.Diagnosis&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("label",{children:["Diagnosis ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:e.Diagnosis})]})},t))),(0,u.jsx)("br",{}),Y.map(((e,t)=>(0,u.jsx)("div",{className:"bill_body bill_body32",children:e.History&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("label",{children:[" ","History ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===e||void 0===e?void 0:e.History})]})},t))),(0,u.jsx)("br",{}),Y.map(((e,t)=>(0,u.jsx)("div",{className:"bill_body bill_body32",children:e.Examination&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("label",{children:[" ","Examination ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===e||void 0===e?void 0:e.Examination})]})},t))),(0,u.jsx)("br",{}),Y.map(((e,t)=>(0,u.jsx)("div",{className:"bill_body bill_body32",children:e.Treatment_Procedure&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("label",{children:[" ","Treatment Procedure ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw6",children:null===e||void 0===e?void 0:e.Treatment_Procedure})]})},t)))]})})]}),(0,u.jsxs)("div",{className:"total_con_bill234",children:[(0,u.jsxs)("div",{className:"bill_body3233",children:[(0,u.jsxs)("label",{children:["Doctor Name ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("span",{className:"dkjfiuw622",children:M.DoctorName})]}),(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"bill_body3233",children:[(0,u.jsxs)("label",{children:[" ","Doctor sign ",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("img",{src:R,alt:"sign",style:{width:"130px",height:"40px"}})]})]}),H&&(0,u.jsx)("button",{className:"print_button",onClick:()=>{setTimeout((()=>{ee()}),200)},children:"Print Data"})]})};var v=n(852),x=n(5393),j=n(3216),g=n(2963),f=n.n(g),N=n(1906);const b=()=>{var e,t;const n=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.workbenchformData})),a=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.UserData})),c=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.UrlLink})),[h,m]=(0,s.useState)({Index:null,DoctorName:"",ProcedureName:"",Sessions:"",IsComplementry:"",Complementry:"",ComplementrySessions:"",appointmentDate:"",PatientID:"",VisitID:"",createdBy:"",Status:"Pending",branchlocation:"",KitName:"",ServiceType:"Procedure"});console.log("formValues",h);const[g,b]=(0,s.useState)([]),[_,y]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[P,w]=(0,s.useState)(""),D=(0,i.d4)((e=>{var t;return null===(t=e.userRecord)||void 0===t?void 0:t.isSidebarOpen})),[I,k]=(0,s.useState)(!1),F=(0,j.Zp)(),[A,R]=(0,s.useState)([]),[T,M]=(0,s.useState)([]),[U,O]=(0,s.useState)({PatientID:"",VisitID:"",AppointmentDate:"",TherapistName:"",TreatmentProcedure:"",NextAppointment:"",Sessions:"",CompletedSessions:"",currentsession:"",AdditionalComments:"",GraftCount:"",Complementry:""}),[E,H]=(0,s.useState)({RatecardType:"",InsuranceName:"",ClientName:""}),[B,G]=(0,s.useState)([]),[K,V]=(0,s.useState)(!1),[W,L]=(0,s.useState)(!1),[q,Y]=(0,s.useState)(null),[z,Q]=(0,s.useState)(!1),[J,X]=(0,s.useState)(!1),[Z,$]=(0,s.useState)(null),ee=(0,s.useRef)(null),[te,ne]=(0,s.useState)(null),[se,ie]=(0,s.useState)(null),[re,oe]=(0,s.useState)("user"),[ae,le]=(0,s.useState)(null),[de,ce]=(0,s.useState)(!1),[he,me]=(0,s.useState)(!1),[ue,pe]=(0,s.useState)(""),ve=e=>{o.oR.warn("".concat(e),{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"50px"}})},xe=()=>{ce(!1),pe("")};(0,s.useEffect)((()=>{r.A.get("".concat(c,"doctorsworkbench/get_procedurename_fromratecard?location=").concat(null===a||void 0===a?void 0:a.location)).then((e=>{b(e.data),console.log("lololkkkk",e.data)})).catch((e=>{console.error(e)})),m((e=>({...e,DoctorName:null===n||void 0===n?void 0:n.DoctorName,PatientID:null===n||void 0===n?void 0:n.PatientID,createdBy:null===a||void 0===a?void 0:a.username,VisitID:null===n||void 0===n?void 0:n.visitNo,PatientID:null===n||void 0===n?void 0:n.PatientID,branchlocation:null===a||void 0===a?void 0:a.location})))}),[null===a||void 0===a?void 0:a.location]);(0,s.useEffect)((()=>{(()=>{const e=null===a||void 0===a?void 0:a.location;r.A.get("".concat(c,"doctorsworkbench/get_Medical_ProductMaster_data_forKit?location=").concat(e,"&ItemType=").concat("KIT")).then((e=>{R(e.data)})).catch((e=>{console.error(e)}))})()}),[null===a||void 0===a?void 0:a.location]);const je=e=>{const{name:t,value:n}=e.target;if("ProcedureName"===t){const e=g.find((e=>e.ProcedureName===n)),s="True"===(null===e||void 0===e?void 0:e.isComplimentary)?"Yes":"No";n.split("-")[0].includes("HT")?m((i=>({...i,[t]:n,Sessions:"",IsComplementry:s,Complementry:"Yes"===s?null===e||void 0===e?void 0:e.ComplimentaryName:"",ComplementrySessions:"Yes"===s?null===e||void 0===e?void 0:e.SessenCounts:""}))):m((i=>({...i,[t]:n,Sessions:0,IsComplementry:s,Complementry:"Yes"===s?null===e||void 0===e?void 0:e.ComplimentaryName:"",ComplementrySessions:"Yes"===s?null===e||void 0===e?void 0:e.SessenCounts:""})))}else m((e=>({...e,[t]:n})))};(0,s.useEffect)((()=>{r.A.get("".concat(c,"doctorsworkbench/get_current_session?Patientid=").concat(null===n||void 0===n?void 0:n.PatientID)).then((e=>{const t=e.data;console.log(t,"----"),M(t||[])})).catch((e=>{console.log(e)}))}),[I,null===n||void 0===n?void 0:n.PatientID]);const ge=e=>{const{name:t,value:n}=e.target;O((e=>({...e,[t]:n})))},fe={facingMode:re},Ne=()=>{oe((e=>"user"===e?"environment":"user"))};(0,s.useEffect)((()=>{r.A.get("".concat(c,"doctorsworkbench/get_procedurestatus?Patientid=").concat(null===n||void 0===n?void 0:n.PatientID)).then((e=>{const t=e.data;console.log(t,"----uuuu"),G(t)})).catch((e=>{console.log(e)}))}),[null===n||void 0===n?void 0:n.PatientID]);const be=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length),i=new Uint8Array(s);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([s],{type:n})};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"Add_items_Purchase_Master",children:(0,u.jsx)("span",{children:"Add Procedures"})}),(0,u.jsxs)("div",{className:"new-patient-registration-form",children:[(0,u.jsxs)("div",{className:"RegisFormcon",style:{justifyContent:"center"},children:[(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"ProcedureName",children:["Treatment Procedure",(0,u.jsx)("span",{children:":"})]}),(0,u.jsxs)("select",{id:"ProcedureName",name:"ProcedureName",value:h.ProcedureName,onChange:je,children:[(0,u.jsx)("option",{value:"",children:"Select "}),Array.isArray(g)?g.map(((e,t)=>(0,u.jsx)("option",{value:e.ProcedureName,children:e.ProcedureName},t))):(0,u.jsx)("option",{disabled:!0,children:"No procedure available"})]})]}),!(null!==(e=h.ProcedureName.split("-")[0])&&void 0!==e&&e.includes("HT"))&&(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"Sessions",children:["Numberof Sessions",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"number",id:"Sessions",name:"Sessions",value:h.Sessions,onChange:je})]}),"Yes"===h.IsComplementry&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"ConsultancyDiscount",children:["Complementary",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"text",id:"ConsultancyDiscount",name:"Complementry",value:h.Complementry,onChange:je})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"ConsultancyDiscount",children:["Complementary Sessions",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"text",name:"ComplementrySessions",value:h.ComplementrySessions,onChange:je})]})]}),(null===(t=h.ProcedureName.split("-")[0])||void 0===t?void 0:t.includes("GFC"))&&(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"ConsultancyDiscount",children:["GFC Kit Name",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{list:"Kitbrowsers",type:"text",id:"KitName",name:"KitName",value:h.KitName,onChange:je}),(0,u.jsx)("datalist",{id:"Kitbrowsers",children:A.map(((e,t)=>(0,u.jsx)("option",{value:e.ItemName,children:e.ItemName},t)))})]}),(0,u.jsx)("button",{className:"RegisterForm_1_btns",onClick:null!==h.Index?()=>{var e,t;let n=["ProcedureName","IsComplementry"];"Yes"===h.IsComplementry?n.push("Complementry","ComplementrySessions"):null!==(e=h.ProcedureName.split("-")[0])&&void 0!==e&&e.includes("GFC")?n.push("Sessions","KitName"):null!==(t=h.ProcedureName.split("-")[0])&&void 0!==t&&t.includes("HT")||n.push("Sessions");const s=n.filter((e=>!h[e]));if(0===s.length){const e=[..._],t=e.findIndex((e=>e.Index===h.Index));e[t]={...h},y(e),m((e=>({...e,Index:null,ProcedureName:"",Sessions:"",Complementry:"",IsComplementry:"",Complementry:"",ComplementrySessions:"",appointmentDate:"",Status:"Pending",KitName:""})))}else alert("please fill the required fields : ".concat(s.join(",")))}:()=>{var e,t;let n=["ProcedureName","IsComplementry"];"Yes"===h.IsComplementry?n.push("Complementry","ComplementrySessions"):null!==(e=h.ProcedureName.split("-")[0])&&void 0!==e&&e.includes("GFC")?n.push("Sessions","KitName"):null!==(t=h.ProcedureName.split("-")[0])&&void 0!==t&&t.includes("HT")||n.push("Sessions");const s=n.filter((e=>!h[e]));if(0===s.length){const e=_.find((e=>e.ProcedureName===h.ProcedureName)),t=_.length+1;e?alert("Procedure Already Exist"):y((e=>[...e,{...h,Index:t}])),m((e=>({...e,Index:null,ProcedureName:"",Sessions:"",Complementry:"",IsComplementry:"",Complementry:"",ComplementrySessions:"",appointmentDate:"",Status:"Pending",KitName:""})))}else alert("please fill the required fields : ".concat(s.join(",")))},children:null!==h.Index?"Update":"Add"})]}),(0,u.jsx)("br",{}),_.length>0&&(0,u.jsx)("div",{className:"Selected-table-container",children:(0,u.jsxs)("table",{className:"selected-medicine-table2",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"S No"}),(0,u.jsx)("th",{children:"Service Type"}),(0,u.jsx)("th",{children:"Therapist Name"}),(0,u.jsx)("th",{children:"Procedure Name"}),(0,u.jsx)("th",{children:"Sessions"}),(0,u.jsx)("th",{children:"Is Complementry"}),(0,u.jsx)("th",{children:"Complementry"}),(0,u.jsxs)("th",{children:["Complementry ",(0,u.jsx)("br",{}),"Sessions"]}),(0,u.jsx)("th",{children:"Kit Name"}),(0,u.jsx)("th",{children:"Action"})]})}),(0,u.jsx)("tbody",{children:_.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.Index}),(0,u.jsx)("td",{children:e.ServiceType}),(0,u.jsx)("td",{children:e.DoctorName}),(0,u.jsx)("td",{children:e.ProcedureName}),(0,u.jsx)("td",{children:e.Sessions||"-"}),(0,u.jsx)("td",{children:e.IsComplementry}),(0,u.jsx)("td",{children:e.Complementry||"-"}),(0,u.jsx)("td",{children:e.ComplementrySessions||"-"}),(0,u.jsx)("td",{children:e.KitName||"-"}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"delnamebtn",onClick:()=>(e=>{m({...e})})(e),children:(0,u.jsx)(v.A,{})})})]},t)))})]})}),(0,u.jsx)("br",{}),_.length>0&&(0,u.jsxs)("div",{className:"Register_btn_con",children:[(0,u.jsx)("button",{className:"RegisterForm_1_btns",onClick:()=>{const e=_.flatMap((e=>{const t=[];return"Yes"===e.IsComplementry&&t.push({ProcedureName:e.Complementry,Therapist_Name:e.DoctorName,Sessions:+e.ComplementrySessions,appointmentDate:n.AppointmentDate,PatientID:n.PatientID,createdBy:null===a||void 0===a?void 0:a.username,DoctorName:n.DoctorName,Status:e.Status,VisitID:n.visitNo,branchlocation:null===a||void 0===a?void 0:a.location,Complementry:e.IsComplementry,KitName:e.KitName}),[{ProcedureName:e.ProcedureName,Therapist_Name:e.DoctorName,Sessions:+e.Sessions,appointmentDate:n.AppointmentDate,PatientID:n.PatientID,createdBy:null===a||void 0===a?void 0:a.username,DoctorName:n.DoctorName,Status:e.Status,VisitID:n.visitNo,branchlocation:null===a||void 0===a?void 0:a.location,Complementry:"No",KitName:e.KitName},...t]}));console.log(e,"----"),r.A.post("".concat(c,"doctorsworkbench/insert_procedure"),e).then((e=>{var t,n,s,i;if(console.log(e.data),null!==(t=e.data)&&void 0!==t&&t.message)i=null===(s=e.data)||void 0===s?void 0:s.message,o.oR.success("".concat(i),{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"50px"}});else if(null!==(n=e.data)&&void 0!==n&&n.warn){var r;ve(null===(r=e.data)||void 0===r?void 0:r.warn)}y([]),k((e=>!e))})).catch((e=>{console.error("Error saving data:",e)}))},children:"Save"}),(0,u.jsx)("button",{onClick:()=>(w("calendar"),void S(!0)),className:"RegisterForm_1_btns",children:"preview"})]}),C&&(0,u.jsx)("div",{className:D?"sideopen_showcamera_profile":"showcamera_profile",onClick:()=>{S(!1)},children:(0,u.jsxs)("div",{className:"newwProfiles newwPopupforreason",onClick:e=>e.stopPropagation(),children:[(0,u.jsx)(p,{modalContent:P}),(0,u.jsx)("div",{className:"Register_btn_con",children:(0,u.jsx)("button",{className:"RegisterForm_1_btns",onClick:()=>{S(!1)},children:(0,u.jsx)(x.A,{})})})]})})]}),T.length>0&&(0,u.jsx)("div",{className:"Add_items_Purchase_Master",children:(0,u.jsx)("span",{children:"Current Therapy List"})}),T.length>0&&(0,u.jsx)("div",{className:"Selected-table-container",children:(0,u.jsxs)("table",{className:"selected-medicine-table2",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"S No"}),(0,u.jsx)("th",{children:"Visit Id"}),(0,u.jsx)("th",{children:"Therapist Name"}),(0,u.jsx)("th",{children:"Procedure Name"}),(0,u.jsx)("th",{children:"Sessions"}),(0,u.jsx)("th",{children:"Sessions Completed"}),(0,u.jsx)("th",{children:"Current Session"}),(0,u.jsx)("th",{children:"Complementry"}),(0,u.jsx)("th",{children:"Kit Name"}),(0,u.jsx)("th",{children:"Status"}),(0,u.jsx)("th",{children:"Action"})]})}),(0,u.jsx)("tbody",{children:T.map(((e,t)=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.ProcedureID}),(0,u.jsx)("td",{children:e.VisitID}),(0,u.jsx)("td",{children:e.TherapistName}),(0,u.jsx)("td",{children:e.Treatment_Procedure}),(0,u.jsx)("td",{children:e.Number_of_Sessions}),(0,u.jsx)("td",{children:e.Number_of_Sessions_completed}),(0,u.jsx)("td",{children:e.current_session}),(0,u.jsx)("td",{children:e.Complementry||"-"}),(0,u.jsx)("td",{children:e.KitName||"-"}),(0,u.jsx)("td",{children:e.Status}),(0,u.jsx)("td",{children:(0,u.jsx)("button",{className:"delnamebtn",onClick:()=>(e=>{O((t=>({...t,PatientID:e.PatientID,VisitID:n.visitNo,AppointmentDate:e.AppointmentDate,TherapistName:e.TherapistName,TreatmentProcedure:e.Treatment_Procedure,Sessions:e.Number_of_Sessions,CompletedSessions:e.Number_of_Sessions_completed,currentsession:e.current_session,CreatedBy:null===a||void 0===a?void 0:a.username,location:null===a||void 0===a?void 0:a.location,Complementry:null===e||void 0===e?void 0:e.Complementry})))})(e),children:(0,u.jsx)(v.A,{})})})]},t)))})]})}),(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"RegisFormcon",style:{justifyContent:"center"},children:[(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"TreatmentProcedure",children:["Procedure Name",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"TreatmentProcedure",id:"TreatmentProcedure",name:"TreatmentProcedure",readOnly:!0,value:U.TreatmentProcedure,onChange:ge})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"Sessions",children:["Sessions",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"number",id:"Sessions",name:"Sessions",readOnly:!0,value:U.Sessions,onChange:ge})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"CompletedSessions",children:["Completed Sessions",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"number",id:"CompletedSessions",name:"CompletedSessions",readOnly:!0,value:U.CompletedSessions,onChange:ge})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"currentsession",children:["Current Sessions",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"number",id:"currentsession",name:"currentsession",readOnly:!0,value:U.currentsession,onChange:ge})]}),U.TreatmentProcedure.split("-")[0].includes("HT")&&(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"GraftCount",children:["Graft Count",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"number",id:"GraftCount",name:"GraftCount",value:U.GraftCount,onChange:ge})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"patientPhoto",children:["Before Treatment",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("div",{className:"file-input-444",children:(0,u.jsxs)("div",{className:"RegisterForm_2",children:[(0,u.jsx)("input",{type:"file",id:"CapturedFile",name:"CapturedFile",accept:"image/*",onChange:e=>{const t=e.target.files[0];ne(t)},style:{display:"none"}}),(0,u.jsx)("label",{htmlFor:"CapturedFile",className:"RegisterForm_1_btns choose_file_update",children:"Choose File"}),(0,u.jsx)("button",{onClick:()=>{V(!0)},className:"RegisterForm_1_btns choose_file_update",children:"Take Pic"}),K&&(0,u.jsx)("div",{className:D?"sideopen_showcamera":"showcamera",onClick:()=>{V(!1)},children:(0,u.jsxs)("div",{className:D?"sideopen_showcamera_1":"showcamera_1",onClick:e=>e.stopPropagation(),children:[W?(0,u.jsx)("img",{src:q,alt:"captured",className:"captured-image11"}):(0,u.jsxs)("div",{className:"camera-container",children:[(0,u.jsx)("div",{className:"web_head",children:(0,u.jsx)("h3",{children:"Image"})}),(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"RotateButton_canva",children:[(0,u.jsx)(l(),{audio:!1,ref:ee,screenshotFormat:"image/jpeg",mirrored:"user"===re,className:"web_cam",videoConstraints:fe}),(0,u.jsx)("div",{className:"web_cam__1",children:(0,u.jsx)("button",{onClick:Ne,children:(0,u.jsx)(d.A,{})})})]})]}),(0,u.jsxs)("div",{className:"web_btn",children:[W?(0,u.jsx)("button",{onClick:()=>{Y(null),L(!1)},className:"btncon_add",children:"Recapture"}):(0,u.jsx)("button",{onClick:()=>{const e=ee.current.getScreenshot();Y(e),L(!0)},className:"btncon_add",children:"Capture"}),(0,u.jsx)("button",{onClick:()=>{V(!1)},className:"btncon_add",children:"Close"})]})]})})]})})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"patientPhoto",children:["After Treatment",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("div",{className:"file-input-444",children:(0,u.jsxs)("div",{className:"RegisterForm_2",children:[(0,u.jsx)("input",{type:"file",id:"CapturedFile",name:"CapturedFile",accept:"image/*",onChange:e=>{const t=e.target.files[0];ie(t)},style:{display:"none"}}),(0,u.jsx)("label",{htmlFor:"CapturedFile",className:"RegisterForm_1_btns choose_file_update",children:"Choose File"}),(0,u.jsx)("button",{onClick:()=>{Q(!0)},className:"RegisterForm_1_btns choose_file_update",children:"Take Pic"}),z&&(0,u.jsx)("div",{className:D?"sideopen_showcamera":"showcamera",onClick:()=>{Q(!1)},children:(0,u.jsxs)("div",{className:D?"sideopen_showcamera_1":"showcamera_1",onClick:e=>e.stopPropagation(),children:[J?(0,u.jsx)("img",{src:Z,alt:"captured",className:"captured-image11"}):(0,u.jsxs)("div",{className:"camera-container",children:[(0,u.jsx)("div",{className:"web_head",children:(0,u.jsx)("h3",{children:"Image"})}),(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"RotateButton_canva",children:[(0,u.jsx)(l(),{audio:!1,ref:ee,screenshotFormat:"image/jpeg",mirrored:"user"===re,className:"web_cam",videoConstraints:fe}),(0,u.jsx)("div",{className:"web_cam__1",children:(0,u.jsx)("button",{onClick:Ne,children:(0,u.jsx)(d.A,{})})})]})]}),(0,u.jsxs)("div",{className:"web_btn",children:[J?(0,u.jsx)("button",{onClick:()=>{$(null),X(!1)},className:"btncon_add",children:"Recapture"}):(0,u.jsx)("button",{onClick:()=>{const e=ee.current.getScreenshot();$(e),X(!0)},className:"RegisterForm_1_btns",children:"Capture"}),(0,u.jsx)("button",{onClick:()=>{Q(!1)},className:"RegisterForm_1_btns",children:"Close"})]})]})})]})})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"AdditionalComments",children:["Additional Comments",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("textarea",{id:"AdditionalComments",name:"AdditionalComments",value:U.AdditionalComments,onChange:ge})]}),(0,u.jsxs)("div",{className:"RegisForm_1",children:[(0,u.jsxs)("label",{htmlFor:"NextAppointment",children:["Next Appointment",(0,u.jsx)("span",{children:":"})]}),(0,u.jsx)("input",{type:"date",id:"NextAppointment",name:"NextAppointment",value:U.NextAppointment,onChange:ge,required:!0})]})]}),(0,u.jsx)("br",{}),(0,u.jsx)("div",{className:"Register_btn_con",children:(0,u.jsx)("button",{className:"RegisterForm_1_btns",onClick:()=>{const e={...U,ServiceType:"Procedure",beforecapturedImage:q?be(q):te,aftercapturedImage:Z?be(Z):se,CreatedBy:null===a||void 0===a?void 0:a.username,location:null===a||void 0===a?void 0:a.location};console.log(e);const t=new FormData;for(const n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);let s=["NextAppointment"];U.TreatmentProcedure.split("-")[0].includes("HT")&&(s=["NextAppointment","GraftCount"]);const i=s.filter((e=>!U[e]));if(i.length>0)ve("please fill allthe fields : ".concat(i.join(",")));else{r.A.post("".concat(c,"doctorsworkbench/insert_therapist_procedure"),t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{if(console.log(t,"-=-=-=-=-=-=-"),"No"===(null===e||void 0===e?void 0:e.Complementry)){let e={PatientID:null===n||void 0===n?void 0:n.PatientID,PatientName:"".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName),VisitID:null===n||void 0===n?void 0:n.visitNo,ServiceType:"Procedure",DoctorName:null===n||void 0===n?void 0:n.DoctorName,ProcedureName:null===U||void 0===U?void 0:U.TreatmentProcedure,appointmentDate:null===n||void 0===n?void 0:n.AppointmentDate,Sessions:null===U||void 0===U?void 0:U.currentsession,Unit:parseInt(null===U||void 0===U?void 0:U.GraftCount)||0,Amount:0,Discount:0,Gstcharge:0,TotalAmount:0,Status:"Pending",location:null===a||void 0===a?void 0:a.location,CreatedBy:null===a||void 0===a?void 0:a.username},t="get_RateCard_Service_Charge",s=E.RatecardType;"Insurance"===E.RatecardType&&(t="get_RateCard_Insurance_Charge",s=E.InsuranceName),"Client"===E.RatecardType&&(t="get_RateCard_client_Charge",s=E.ClientName);const i=async()=>{try{const n=await r.A.get("".concat(c,"usercontrol/").concat(t,"?servicetype=Procedure&servicename=").concat(U.TreatmentProcedure,"&ratecardtype=").concat(s,"&location=").concat(null===a||void 0===a?void 0:a.location)),i=n.data.data[0];console.log(n.data),null!==i&&void 0!==i&&i.Charge&&(e.Amount=parseFloat(i.Charge)||0,e.Gstcharge=parseFloat(i.GstCharge)||0,e.TotalAmount=parseFloat(i.Charge)*parseFloat(e.Unit)||0);const o=[{...e}],l=await r.A.post("".concat(c,"GeneralBilling/insertGeneral_Billing_Data"),o);console.log(l,"=====")}catch(n){console.error("Error in fetching and posting billing data:",n)}};i()}k((e=>!e)),O({PatientID:"",VisitID:"",AppointmentDate:"",TherapistName:"",TreatmentProcedure:"",NextAppointment:"",Sessions:"",CompletedSessions:"",currentsession:"",AdditionalComments:""}),Y(null),$(null)})).catch((e=>{console.log(e)}));"Yes"===(window.confirm("Do you Complete Procedure?")?"Yes":"No")&&F("/Home/Treament-QueueList")}},children:"Save"})}),(0,u.jsx)(o.N9,{}),(0,u.jsx)(f(),{isOpen:de,onRequestClose:xe,style:{content:{position:"absolute",inset:"100px",border:"1px solid rgb(204, 204, 204)",background:"rgb(97 90 90 / 75%)",overflow:"auto",borderRadius:"4px",outline:"none",padding:"0px"}},children:(0,u.jsxs)("div",{className:"pdf_img_show",children:[P.toLowerCase().startsWith("data:application/pdf;base64,")?(0,u.jsx)("iframe",{title:"PDF Viewer",src:ue,style:{width:"100%",height:"435px",border:"1px solid rgba(0, 0, 0, 0.5)"}}):(0,u.jsx)("img",{src:ue,alt:"Concern Form",style:{width:"80%",height:"75%",marginTop:"20px"}}),(0,u.jsx)("div",{className:"jhuhhjh",children:(0,u.jsx)(N.A,{style:{color:"white"},className:"clse_pdf_img",onClick:xe,children:(0,u.jsx)(x.A,{style:{fontSize:"40px",backgroundColor:"#54d854bf",borderRadius:"40px"}})})})]})})]})}},4783:(e,t,n)=>{"use strict";var s=n(4994);t.A=void 0;var i=s(n(39)),r=n(579);t.A=(0,i.default)([(0,r.jsx)("path",{d:"M16 7h-1l-1-1h-4L9 7H8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m-4 7c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"},"0"),(0,r.jsx)("path",{d:"m8.57.51 4.48 4.48V2.04c4.72.47 8.48 4.23 8.95 8.95h2C23.34 3.02 15.49-1.59 8.57.51m2.38 21.45c-4.72-.47-8.48-4.23-8.95-8.95H0c.66 7.97 8.51 12.58 15.43 10.48l-4.48-4.48z"},"1")],"Cameraswitch")},7029:function(e,t,n){var s;s=function(e){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var s=n("react"),i=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function s(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),r=function(){return r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},o=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};function a(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,s){t.call(navigator,e,n,s)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,a()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(a()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),s=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),i=e.minScreenshotWidth!==t.minScreenshotWidth,r=e.minScreenshotHeight!==t.minScreenshotHeight;(s||i||r)&&(this.canvas=null,this.ctx=null),(n||s)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var s=this.getCanvas(e);return s&&s.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var s=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var r=s/i;i=(s=n.minScreenshotWidth||this.video.clientWidth)/r,n.minScreenshotHeight&&i<n.minScreenshotHeight&&(s=(i=n.minScreenshotHeight)*r)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||s,this.canvas.height=(null===e||void 0===e?void 0:e.height)||i,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,a=this.canvas;return o&&a&&(a.width=(null===e||void 0===e?void 0:e.width)||a.width,a.height=(null===e||void 0===e?void 0:e.height)||a.height,n.mirrored&&(o.translate(a.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||a.width,(null===e||void 0===e?void 0:e.height)||a.height),n.mirrored&&(o.scale(-1,1),o.translate(-a.width,0))),a},t.prototype.requestUserMedia=function(){var e=this,n=this.props,s=function(s,i){var r={video:"undefined"===typeof i||i};n.audio&&(r.audio="undefined"===typeof s||s),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(r).then((function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)s(n.audioConstraints,n.videoConstraints);else{var i=function(e){return{optional:[{sourceId:e}]}},r=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,o=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)}));var a=r(n.audioConstraints);a&&(t=a);var l=r(n.videoConstraints);l&&(o=l),s(i(t),i(o))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(s){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,i=n.audio,a=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),d=n.style,c=void 0===d?{}:d,h=n.children,m=o(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),u=l?r(r({},c),{transform:(c.transform||"")+" scaleX(-1)"}):c,p={getScreenshot:this.getScreenshot.bind(this)};return s.createElement(s.Fragment,null,s.createElement("video",r({autoPlay:!0,disablePictureInPicture:a,src:t.src,muted:!i,playsInline:!0,ref:function(t){e.video=t},style:u},m)),h&&h(p))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(s.Component);t.default=l},react:function(t,n){t.exports=e}}).default},e.exports=s(n(5043))}}]);
//# sourceMappingURL=701.12d741bf.chunk.js.map